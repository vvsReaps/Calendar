function getExtendedStats() {
  const tradesByDay = {};
  const lotsByDay = {};
  const dayPL = {};

  Object.entries(DATA).forEach(([k, v]) => {
    const [Y, M, D] = k.split('-').map(Number);
    const dt = new Date(Y, M-1, D);
    if (dt.getFullYear() !== current.getFullYear() || dt.getMonth() !== current.getMonth()) return;

    const arr = (v.trades || []).filter(x => !Number.isNaN(x));
    if (arr.length === 0) return;

    const daySum = arr.reduce((a,b)=>a+b,0);
    dayPL[k] = daySum;
    tradesByDay[k] = arr.length;
    lotsByDay[k] = arr.length; // If you want “lots” separate, change this calc
  });

  const mostActive = Object.keys(tradesByDay).sort((a,b)=>tradesByDay[b]-tradesByDay[a])[0];
  const best = Object.keys(dayPL).sort((a,b)=>dayPL[b]-dayPL[a])[0];
  const worst = Object.keys(dayPL).sort((a,b)=>dayPL[a]-dayPL[b])[0];

  const totalTrades = Object.values(tradesByDay).reduce((a,b)=>a+b,0);
  const totalLots = Object.values(lotsByDay).reduce((a,b)=>a+b,0);
  const avgDuration = totalTrades ? 6 : 0; // Replace with real calc if you track durations

  return {
    mostActive, activeCount: tradesByDay[mostActive] || 0,
    best, bestPL: dayPL[best] || 0,
    worst, worstPL: dayPL[worst] || 0,
    totalTrades, totalLots, avgDuration
  };
}
